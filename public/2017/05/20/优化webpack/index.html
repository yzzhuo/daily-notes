<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
    <title>
      
        优化webpack |
          
            I am June
    </title>
    <!-- 主css -->
    <link rel="stylesheet" href="/sass/main.css">
      <!-- seo -->
      <meta name="description" content="最近的工作不大忙，大致是看看现有的代码，熟悉业务，修复一些小问题。而最近对某个项目代码进行webpack优化，得出了关于webpack优化的几个方法。  webpack内置优化工具  webpack.optimize.UglifyJsPlugin 代码压缩：配置选项可以参考uglify-webpack-plugin 1234567891011121314151617new UglifyJsPlug">
<meta name="keywords" content="前端工具">
<meta property="og:type" content="article">
<meta property="og:title" content="优化webpack">
<meta property="og:url" content="http://blog.yzzhuo.com/2017/05/20/优化webpack/index.html">
<meta property="og:site_name" content="I am June">
<meta property="og:description" content="最近的工作不大忙，大致是看看现有的代码，熟悉业务，修复一些小问题。而最近对某个项目代码进行webpack优化，得出了关于webpack优化的几个方法。  webpack内置优化工具  webpack.optimize.UglifyJsPlugin 代码压缩：配置选项可以参考uglify-webpack-plugin 1234567891011121314151617new UglifyJsPlug">
<meta property="og:updated_time" content="2017-10-29T15:21:03.828Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="优化webpack">
<meta name="twitter:description" content="最近的工作不大忙，大致是看看现有的代码，熟悉业务，修复一些小问题。而最近对某个项目代码进行webpack优化，得出了关于webpack优化的几个方法。  webpack内置优化工具  webpack.optimize.UglifyJsPlugin 代码压缩：配置选项可以参考uglify-webpack-plugin 1234567891011121314151617new UglifyJsPlug">
        <!-- facicon -->
        
          <link rel="icon" href="http://7xp1k3.com1.z0.glb.clouddn.com/octocat-de-los-muertos.jpg">
          
            <!-- 统计 -->
            
              <script>
                var _hmt = _hmt || [];
                (function () {
                  var hm = document.createElement("script");
                  hm.src = "//hm.baidu.com/hm.js?c21994907883f37ffd80e13627dd4faa";
                  var s = document.getElementsByTagName("script")[0];
                  s.parentNode.insertBefore(hm, s);
                })();
              </script>
              
                
                    <script src="http://cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>
</head>
	<body>
		<div class="main">
			<div id="mobile-bar">
    <a class="menu-button"></a>
    <a class="logo" href="/">Yzz</a>
</div>
<header class="nav-header">
    <a href="/" class="logo-link">Yzz</a>
    
            
    <ul class="nav nav-list">
        <li class="nav-list-item"><a href="/">Home</a></li>
        
            
        
            
        <li class="nav-list-item"><a href="/about">About</a></li>
            
        
            
        <li class="nav-list-item"><a href="/tags">Tags</a></li>
            
        
            
        <li class="nav-list-item"><a href="/archives">Archives</a></li>
            
        
    </ul>
</header>
<div class="sidebar">
    
            
    <ul class="main-menu">
        <li class="main-menu-item"><a href="/">Home</a></li>
        
            
        
            
        <li class="main-menu-item"><a href="/about">About</a></li>
            
        
            
        <li class="main-menu-item"><a href="/tags">Tags</a></li>
            
        
            
        <li class="main-menu-item"><a href="/archives">Archives</a></li>
            
        
    </ul>
</div>

<h1 class="blog-title">The Yzz Blog</h1>

			
<article class="article-main" itemscope itemprop="blogPost">
        <div class="articleCon">
            <header class="article-header">
                <h1 itemprop="name">
                    <a href="/2017/05/20/优化webpack/" class="article-title">优化webpack</a>
                </h1>
            </header>
            
<div class="bookmark" id="bookmark">
    <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#参考资料"><span class="toc-text">参考资料</span></a></li></ol>
</div>

            
            <div class="article-meta">
                <div class="article-dateTime">
    <a href="/2017/05/20/优化webpack/" class="article-date">
        <time datetime="May 20th 2017" itemprop="datePublished">
            May 20th 2017
        </time>
    </a>
</div>

            </div>
            <div class="article-inner">
                <div class="article-entry" itemprop="articleBody">
                    <p>最近的工作不大忙，大致是看看现有的代码，熟悉业务，修复一些小问题。而最近对某个项目代码进行webpack优化，得出了关于webpack优化的几个方法。</p>
<ol>
<li><p>webpack内置优化工具</p>
<ul>
<li><p>webpack.optimize.UglifyJsPlugin 代码压缩：配置选项可以参考<a href="https://doc.webpack-china.org/plugins/uglifyjs-webpack-plugin/" target="_blank" rel="external">uglify-webpack-plugin</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> UglifyJsPlugin(&#123;</div><div class="line">    <span class="comment">// 最紧凑的输出</span></div><div class="line">    beautify: <span class="literal">false</span>,</div><div class="line">    <span class="comment">// 删除所有的注释</span></div><div class="line">    comments: <span class="literal">false</span>,</div><div class="line">    compress: &#123;</div><div class="line">      <span class="comment">// 在UglifyJs删除没有用到的代码时不输出警告  </span></div><div class="line">      warnings: <span class="literal">false</span>,</div><div class="line">      <span class="comment">// 删除所有的 `console` 语句</span></div><div class="line">      <span class="comment">// 还可以兼容ie浏览器</span></div><div class="line">      drop_console: <span class="literal">true</span>,</div><div class="line">      <span class="comment">// 内嵌定义了但是只用到一次的变量</span></div><div class="line">      collapse_vars: <span class="literal">true</span>,</div><div class="line">      <span class="comment">// 提取出出现多次但是没有定义成变量去引用的静态值</span></div><div class="line">      reduce_vars: <span class="literal">true</span>,</div><div class="line">    &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><ul>
<li><p>​</p>
</li>
<li><ul>
<li><a href="https://doc.webpack-china.org/plugins/define-plugin/" target="_blank" rel="external">DefinePlugin</a> 替换某些包为生产环境版本，比如react。</li>
<li><a href="https://doc.webpack-china.org/plugins/commons-chunk-plugin/" target="_blank" rel="external">CommonsChunkPlugin</a> 公共模块的拆分，使用于多页面引用了公共模块的情景。</li>
<li><a href="https://doc.webpack-china.org/plugins/extract-text-webpack-plugin/" target="_blank" rel="external">ExtractTextWebpackPlugin</a> 把内嵌在JS bundle的样式放到独立的CSS文件。适用于样式文件较大的情况。</li>
</ul>
</li>
<li><p>根据打包信息来分析可优化点</p>
<p>生成stats.json: <code>webpack --profile --json &gt; stas.json</code></p>
<ul>
<li><p>可视化分析工具:</p>
<p>线上web：</p>
<ul>
<li><a href="https://alexkuz.github.io/webpack-chart/" target="_blank" rel="external">webpack chart</a>：适合来总体查看打包的情况（各部分的占用空间）</li>
<li><a href="http://webpack.github.io/analyse/" target="_blank" rel="external">webpack analyse</a>:适合用来追踪问题的来源</li>
</ul>
<p>插件：</p>
<ul>
<li><a href="http://www.opendigg.com/p/webpack-bundle-analyzer" target="_blank" rel="external">webpack-bundle-analyzer</a>: 在webpack.config.json里面配置好，可以在每次build的时候自动在8080端口启动一个服务器显示webpack打包情况</li>
</ul>
</li>
<li><p>参数</p>
<ul>
<li>stat size: 原始打包的大小</li>
<li>parse size: uglify压缩后的大小</li>
<li>gizp size：启动gizp后的大小</li>
<li>lodash按需加载</li>
</ul>
</li>
</ul>
</li>
<li><p>lodash是个好东西，但是也是个大家伙（500+k），如果可以按需加载，可以大大减少打包的lodash的体积。</p>
<p>优化方法：</p>
<ul>
<li>利用webpack2的treeshaking可以一定程度削减没有用到的lodash模块。启动treeshaking的方法</li>
<li>更彻底的方法是使用<a href="https://github.com/lodash/lodash-webpack-plugin" target="_blank" rel="external">lodash-webpack-plugin</a>插件。（ps：如果是使用了typescript的项目，需要用awesome-typescript-loader或者ts-loader+babel-loader来处理ts/tsx文件，因为使用这个插件要用到bebel-plugin-lodash，还要注意它支持module为es2015或者es6的模块机制，设置成commonjs的话是不生效的！！</li>
</ul>
</li>
<li><p>对于应用目标环境是node的libray,可以采用[<a href="https://www.npmjs.com/package/webpack-node-externals" target="_blank" rel="external">webpack-node-externals</a>剔除不必要的包。</p>
<h4 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h4><ul>
<li><a href="https://webpack.js.org/guides/production-build/" target="_blank" rel="external">Webpack官方文档</a></li>
<li><a href="https://github.com/youngwind/blog/issues/65" target="_blank" rel="external">webpack打包bundle.js体积大小优化</a></li>
<li><a href="https://imys.net/20161217/webpack-use-lodash.html" target="_blank" rel="external">lodash按需加载的几种方式</a></li>
<li><a href="http://imweb.io/topic/5868e1abb3ce6d8e3f9f99bb" target="_blank" rel="external">webpack2 终极优化- 腾讯Web前端IMWeb 团队社区| blog | 团队博客</a></li>
</ul>
</li>
</ul>
</li>
</ol>

                </div>
                
<nav id="article-nav">
  
    <a href="/2017/06/01/原来除了box-shadow,还有drop-shadow/" id="article-nav-newer" class="article-nav-link-wrap">
      <div class="article-nav-title">
        
          原来除了box-shadow,还有drop-shadow >
        
      </div>
    </a>
  
  
    <a href="/2017/04/01/项目总结-wps/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title"> < 项目总结-wps</div>
    </a>
  
</nav>


            </div>
        </div>
        
            <div id="disqus_thread"></div>
<script>
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document,
            s = d.createElement('script');

        s.src = '//yzzting.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
<script id="dsq-count-scr" src="//yzzting.disqus.com/count.js" async></script>

        
        
</article>



		</div>
		<div id="heart"></div>

    <footer class="blog-footer" id="blog-footer">
        <div id="footer-info" class="inner">
            Made with ♥ by <a href="https://github.com/yzzting/hexo-theme-MyFairLady" target="_blank">MyFairLady</a>
        </div>
    </footer>
    <script src="/js/sidebar.js"></script>
    <script src="/js/toTop.js"></script>
    <script src="/js/bookmark.js"></script>
	</body>
	</html>
